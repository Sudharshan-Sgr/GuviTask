<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile Page</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.6.1.js"
        integrity="sha256-3zlB5s2uwoUzrXK3BT7AX3FyvojsraNFxCc2vC/7pNI=" crossorigin="anonymous"
        ></script>
    
   <script> 
        $(function () { 
            if(localStorage.getItem("id") == "null"){
                $(location).prop("href","/guvi/login/");
            }
            $("#log_out").click(function(e){
                localStorage.setItem("id", "null");
                $(location).prop("href", "/guvi/login/");
            });
            $.ajax({ 
                   type: 'post',
                    url: 'load_profile.php',
                    data:{
                        "id" : localStorage.getItem("id")
                    },
                    success: function (response) {
                        console.log(response);
                        $('input[name="fullname"]').val(response["fullname"]);
                        $('input[name="email"]').val(response["mail"]);
                        $('input[name="email"]').prop('readonly', true);
                        $('input[name="password"]').val(response["password"]);
                        if(response["found"]){
                            var data = response["data"];
                            $('input[name="phno"]').val(data["phno"]);
                            $('input[name="age"]').val(data["age"]);
                            $('input[name="dob"]').val(data["dob"]);
                            $('input[name="address"]').val(data["address"]);
                            $('input[name="district"]').val(data["district"]);
                            $('input[name="state"]').val(data["state"]);
                            $('input[name="country"]').val(data["country"]);
                            $('input[name="pin"]').val(data["pin"]);
                        }
                    },
                    error: function(){
                        alert("error loading data");
                    }
            });
            $('form').on('submit', function(event){
                event.preventDefault();
                $.ajax({
                    type: "post",
                    url: 'profile.php',
                    data: $('form').serialize(),
                    success: function(data){
                        console.log(data);
                    },
                    error: function(data){
                        console.log(data);
                    }
                });
            });
       });

   </script>
</head>
<body>
    <div class="container mt-5 card text-center">
        <div class="card-body">
            <h5 class="card-title m-5">Profile</h5>
            <form action = "profile.php">
                <div class = "row mb-3">
                    <label for = "name" class="col-form-label col-sm-2">Full Name</label>
                    <div class="col-sm-10">
                        <input type = "text" class = "form-control" placeholder = "Enter your name" name="fullname" id="name" required disabled>
                    </div>
                </div>
                <div class = "row mb-3">
                    <label for = "email" class="col-form-label col-sm-2">Email ID</label>
                    <div class="col-sm-10">
                        <input type = "email" class = "form-control" placeholder = "Enter your Email Adress" name="email" id="email" required>
                    </div>
                </div>
                <div class = "row mb-3">
                    <label for = "password" class="col-form-label col-sm-2">Password</label>
                    <div class="col-sm-10">
                        <input type = "password" class = "form-control"  placeholder = "Enter your password" name="password" id="password" required disabled>
                    </div>
                </div>
                <div class = "row mb-3">
                    <label for = "phno" class="col-form-label col-sm-2">Phno</label>
                    <div class="col-sm-10">
                        <input type = "text" class = "form-control" placeholder = "Enter your mobile number" name="phno" id="phno" required>
                    </div>
                </div>

                <div class = "row mb-3">
                    <label for = "age" class="col-form-label col-sm-2">Age</label>
                    <div class="col-sm-10">
                        <input type = "text" class = "form-control" placeholder = "Enter your Age" name="age" id="age" required>
                    </div>
                </div>

                <div class = "row mb-3">
                    <label for = "dob" class="col-form-label col-sm-2">DOB</label>
                    <div class="col-sm-10">
                        <input type = "date" class = "form-control"  name="dob" id="dob" required>
                    </div>
                </div>

                <div class = "row mb-3">
                    <label for = "address" class="col-form-label col-sm-2">Address</label>
                    <div class="col-sm-10">
                        <input type = "text" class = "form-control" placeholder = "Enter your Address" name="address" id="address" required>
                    </div>
                </div>
                <div class = "row mb-3">
                    <label for = "district" class="col-form-label col-sm-2">District</label>
                    <div class="col-sm-10">
                        <input type = "text" class = "form-control" placeholder = "Enter your District" name="district" id="district" required>
                    </div>
                </div>
                <div class = "row mb-3">
                    <label for = "pin" class="col-form-label col-sm-2">Pin Code</label>
                    <div class="col-sm-10">
                        <input type = "text" class = "form-control" placeholder = "Enter your pin code" name="pin" id="pin" required>
                    </div>
                </div>
                <div class = "row mb-3">
                    <label for = "state" class="col-form-label col-sm-2">State</label>
                    <div class="col-sm-10">
                        <input type = "text" class = "form-control" placeholder = "Enter your State" name="state" id="state" required>
                    </div>
                </div>
                <div class = "row mb-3">
                    <label for = "country" class="col-form-label col-sm-2">Country</label>
                    <div class="col-sm-10">
                        <input type = "text" class = "form-control" placeholder = "Enter your County" name="country" id="country" required>
                    </div>
                </div>

                <div class="row mb-3 justify-content-center">
                    <input type = "submit" class="btn btn-primary col-sm-1 m-5" value = "Update">
                    <input type="button" id="log_out" class="btn btn-primary col-sm-1 m-5" value="Log Out">
                </div>
            </form>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
    
</body>
</html>